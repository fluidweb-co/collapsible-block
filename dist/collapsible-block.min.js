!function(e,t){"function"==typeof define&&define.amd?define([],t()):"object"==typeof exports?module.exports=t():e.CollapsibleBlock=t()}("undefined"!=typeof global?global:this.window||this.global,function(e){"use strict";function n(){var e,t=document.createElement("fakeelement"),n={transition:"transitionend",OTransition:"oTransitionEnd",MozTransition:"transitionend",WebkitTransition:"webkitTransitionEnd"};for(e in n)if(void 0!==t.style[e])return n[e];return"transitionend"}function i(e){e.target.closest(c.handlerSelector)&&(e.preventDefault(),e=e.target.closest(c.handlerSelector),(e=(document.querySelector("#"+e.getAttribute(c.targetAttribute))||e).closest(c.elementSelector))&&r.toggleState(e))}function l(e){var t=e.style.position,n=e.style.display,i=e.style.visibility,l=e.style.transition,s=e.style.height;e.style.position="absolute",e.style.display="block",e.style.visibility="hidden",e.style.transition="none",e.style.height="";var a=e.scrollHeight;return e.style.position=t,e.style.display=n,e.style.visibility=i,e.style.transition=l,e.style.height=s,a}function s(e){return e.getBoundingClientRect().height}function o(e){r.expand(e.element),requestAnimationFrame(function(){l(e.contentElement)>e.settings.maxHeight&&r.collapse(e.element)})}var a=!1,r={managers:[],states:{COLLAPSED:"collapsed",FIRST_EXPANDED:"first-expanded",EXPANDED:"expanded"}},c={},d={bodyClass:"has-collapsible-block",elementSelector:"[data-collapsible]",contentElementSelector:"[data-collapsible-content]",contentInnerSelector:".collapsible-content__inner",handlerSelector:"[data-collapsible-handler]",isCollapsedClass:"is-collapsed",isActivatedClass:"is-activated",cssTransition:"height .15s linear",targetAttribute:"data-collapsible-target",maxHeightAttribute:"data-collapsible-max-height",createHandlerAttribute:"data-collapsible-create-handler",changeStateOnResizeAttribute:"data-collapsible-change-state-resize",initialState:r.states.FIRST_EXPANDED,initialStateAttribute:"data-collapsible-initial-state",firstExpandedDelay:100,idPrefix:"collapsible",createHandler:!1,maxHeight:0,handlerTemplate:'<a href="#collapsible" role="button" data-collapsible-handler>Read more</a>',contentInnerTemplate:'<div class="collapsible-content__inner"></div>'},m=function(){var n={},i=!1,e=0;"[object Boolean]"===Object.prototype.toString.call(arguments[0])&&(i=arguments[0],e++);for(;e<arguments.length;e++)!function(e){for(var t in e)e.hasOwnProperty(t)&&(i&&"[object Object]"===Object.prototype.toString.call(e[t])?n[t]=m(n[t],e[t]):n[t]=e[t])}(arguments[e]);return n},g=function(e){e&&"height"!==e.propertyName||(e.target.style.height="",e.target.style.overflow="",e.target.removeEventListener(n(),g))};return r.getInstance=function(e){for(var t,n=0;n<r.managers.length;n++){var i=r.managers[n];if(i.element==e){t=i;break}}return t},r.collapse=function(e){var t=r.getInstance(e);t&&(t.element.classList.add(t.settings.isCollapsedClass),t.contentElement.removeEventListener(n(),g),t.contentElement.style.overflow="hidden",requestAnimationFrame(function(){t.contentElement.style.height=s(t.contentElement)+"px",requestAnimationFrame(function(){t.contentElement.style.height=t.settings.maxHeight+"px"})}))},r.expand=function(e){var t=r.getInstance(e);t&&(t.contentElement.style.height=s(t.contentElement)+"px",t.contentElement.addEventListener(n(),g),requestAnimationFrame(function(){var e=l(t.contentElement);requestAnimationFrame(function(){t.contentElement.style.height=e+"px",t.element.classList.remove(t.settings.isCollapsedClass)})}))},r.toggleState=function(e){var t=r.getInstance(e);t&&(e.classList.contains(t.settings.isCollapsedClass)?r.expand(e):r.collapse(e))},r.getState=function(e){var t=r.getInstance(e);if(!t)return!1;var n=r.states.EXPANDED;return n=e.classList.contains(t.settings.isCollapsedClass)?r.states.COLLAPSED:n},r.initializeElement=function(e){var t={};r.managers.push(t),t.element=e,t.settings=m(c),t.contentElement=t.element.matches(c.contentElementSelector)?t.element:t.element.querySelector(t.settings.contentElementSelector),t.contentElement||(t.contentElement=t.element),""==t.element.id&&(t.element.id=t.settings.idPrefix+"_"+r.managers.length),""==t.contentElement.id&&(t.contentElement.id=t.element.id+"__content");var n=t.contentElement.getAttribute(t.settings.maxHeightAttribute);t.settings.maxHeight=n&&""!=n?parseInt(n):t.settings.maxHeight;var i,l=t.element.getAttribute(t.settings.createHandlerAttribute);t.settings.createHandler="true"==l||"false"==l?Boolean(l):t.settings.createHandler,t.settings.createHandler&&(n=(e=t).element,i=e.contentElement,(l=document.createElement("div")).innerHTML=e.settings.handlerTemplate.trim(),e.handlerElement=l.childNodes[0],e.handlerElement.setAttribute(e.settings.targetAttribute,i.id),e.handlerElement.setAttribute("href","#"),e.handlerElement.setAttribute("role","button"),n.insertBefore(l.childNodes[0],i.nextSibling)),(i=t).contentElement.querySelector(i.settings.contentInnerSelector)||(s=i.contentElement,(a=document.createElement("div")).innerHTML=i.settings.contentInnerTemplate.trim(),a.childNodes[0].innerHTML=s.innerHTML,s.innerHTML=a.innerHTML);var s=t.contentElement.getAttribute(t.settings.initialStateAttribute),a=s||t.settings.initialState,s=Array.prototype.indexOf.call(t.element.parentNode.children,t.element);a==r.states.EXPANDED||a==r.states.FIRST_EXPANDED&&0==s?setTimeout(function(){r.expand(t.element)},t.settings.firstExpandedDelay):setTimeout(function(){r.collapse(t.element)},t.settings.firstExpandedDelay);s=t.element.getAttribute(t.settings.changeStateOnResizeAttribute);t.settings.changeStateOnResize=!(!s||""==s)&&Boolean(s),t.settings.changeStateOnResize&&(o(t),window.addEventListener("resize",function(){o(t)}));s=window.getComputedStyle(t.contentElement).transition,s=""!=s?s+", "+t.settings.cssTransition:t.settings.cssTransition;t.contentElement.style.transition=s,t.isActivated=!0,t.element.classList.add(t.settings.isActivatedClass)},r.init=function(e){if(!a){c=m(d,e);for(var t=document.querySelectorAll(c.elementSelector),n=0;n<t.length;n++)r.initializeElement(t[n]);document.addEventListener("click",i),document.body.classList.add(c.bodyClass),a=!0}},r});
//# sourceMappingURL=maps/collapsible-block.min.js.map
